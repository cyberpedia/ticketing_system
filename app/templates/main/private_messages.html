{% extends 'base.html' %}
{% block title %}Private Messages{% endblock %}
{% block content %}
<h2>Private Messages</h2>

<form method="POST" enctype="multipart/form-data" class="mb-4">
    {{ form.hidden_tag() }}
    <div class="mb-3">{{ form.recipient.label }} {{ form.recipient(class="form-control") }}</div>
    <div class="mb-3">{{ form.message.label }} {{ form.message(class="form-control") }}</div>
    <div class="mb-3">{{ form.attachment.label }} {{ form.attachment(class="form-control") }}</div>
    <div>{{ form.submit(class="btn btn-primary") }}</div>
</form>

<hr>
{% for msg in messages %}
<div class="card mb-2">
    <div class="card-body">
        <strong>{{ msg.sender.username }}</strong> â†’ <strong>{{ msg.recipient.username }}</strong>
        <small class="text-muted">{{ msg.timestamp.strftime('%Y-%m-%d %H:%M') }}</small>
        <p>{{ msg.message }}</p>
        {% if msg.attachment %}
        <p><a href="{{ url_for('static', filename='uploads/' ~ msg.attachment) }}" target="_blank">Attachment</a></p>
        {% endif %}
    </div>
</div>
{% endfor %}
{% endblock %}
